  async getCoursesTeacher(idProfesor: number) {
    return this.prisma.$queryRawUnsafe<
      Array<{
        id: number;
        idCur: number;
        NombreCurso: string;
        Publico: number;
        Profesor: number;
        SegundoPro: number;
        Valor: number; 
        Horas: number;
        Lugar: string;
        Inicio: Date;
        Fin: Date;
        LunesIni: string;
        LunesFin: string;
        MartesIni: string;                       
        MartesFin: string;                        
        MiercolesIni: string;
        MiercolesFin: string;              
        JuevesIni: string;                       
        JuevesFin: string;                  
        ViernesIni: string;                 
        ViernesFin: string;                     
        SabadoIni: string;                      
        SabadoFin: string;                       
        DomingoIni: string;                     
        DomingoFin: string;
        Periodo: number;
        Linea: number;
        Proexterno, 
        Estado: number;
        Modalidad: number;
        Unidad: number;
        docInscr: string;
        nombre: string | null;
        fecreg: Date;
        rol: string;
        CupoMax: number | null;
        Nota: number | null;
        Especificacion: string | null;
        InscritoNumerico: number | null;
      }>
    >(
      `SELECT 
        i.id,
        i.idCur,
        c.NombreCurso,
        c.Publico,
        c.Profesor,
        c.SegundoPro,
        c.Valor,
        c.Horas,
        c.Lugar,
        c.Inicio,
        c.Fin,
        c.LunesIni,                          
        c.LunesFin,                         
        c.MartesIni,                       
        c.MartesFin,                        
        c.MiercolesIni,                      
        c.MiercolesFin,                      
        c.JuevesIni,                         
        c.JuevesFin,                         
        c.ViernesIni,                        
        c.ViernesFin,                        
        c.SabadoIni,                         
        c.SabadoFin,                         
        c.DomingoIni,                        
        c.DomingoFin,
        c.Periodo,
        c.Linea,
        c.Proexterno, 
        c.Estado,
        c.Modalidad,
        c.Unidad,
        i.docInscr,
        e.nombre,
        i.fecreg,
        c.CupoMax,
        TRY_CAST(i.docInscr AS INT) AS InscritoNumerico,
        n.Nota,
        l.Especificacion,
        CASE 
          WHEN c.Profesor = ${idProfesor} THEN 'Titular'
          WHEN c.SegundoPro = ${idProfesor} THEN 'Segundo'
          ELSE 'Otro'
        END AS rol
      FROM gescur.Cursos c
      LEFT JOIN gescur.Inscripciones i ON i.idCur = c.id
      LEFT JOIN gescur.emp_nomina e ON i.docInscr = e.id_emp
      OUTER APPLY (
        SELECT TOP 1 n.Nota 
        FROM gescur.Notas n 
        WHERE n.idInscrito = TRY_CAST(i.docInscr AS INT)
        ORDER BY n.id ASC
      ) n
      LEFT JOIN gescur.Listas l ON l.id = n.Nota
      WHERE (c.Profesor = ${idProfesor} OR c.SegundoPro = ${idProfesor})
        AND i.est = 1`
    );
  }
