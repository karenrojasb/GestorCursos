import { Injectable } from '@nestjs/common';
import { PrismaService } from 'src/prisma/prisma.service';

@Injectable()
export class UsuarioService {
  constructor(private prisma: PrismaService) {}

  async obtenerUsuarios() {
    return await this.prisma.$queryRaw`
      SELECT 
        e.id_emp AS cedula, 
        e.nombre, 
        r.nombre AS rol, 
        e.e_mail 
      FROM gescur.emp_nomina e
      LEFT JOIN gescur.roles r ON e.público = r.id`;
  }

  async obtenerUsuarioPorCedula(cedula: string) {
    return await this.prisma.$queryRaw`
      SELECT 
        e.id_emp AS cedula, 
        e.nombre, 
        r.nombre AS rol, 
        e.e_mail 
      FROM gescur.emp_nomina e
      LEFT JOIN gescur.roles r ON e.público = r.id
      WHERE e.id_emp = ${cedula}`;
  }
}